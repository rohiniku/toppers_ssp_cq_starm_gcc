
		TOPPERS/SSPカーネル
		拡張パッケージ仕様

		対応バージョン: Release 1.2.1
		最終更新: 2013年4月24日

このドキュメントは，TOPPERS/SSPカーネルの機能を拡張するための拡張
パッケージに付いて記述したものである．

----------------------------------------------------------------------
     TOPPERS/SSP Kernel
         Smallest Set Profile Kernel
 
     Copyright (C) 2011,2013 by Meika Sugimoto
 
 上記著作権者は，以下の(1)〜(4)の条件を満たす場合に限り，本ソフトウェ
 ア（本ソフトウェアを改変したものを含む．以下同じ）を使用・複製・改
 変・再配布（以下，利用と呼ぶ）することを無償で許諾する．
 (1) 本ソフトウェアをソースコードの形で利用する場合には，上記の著作
     権表示，この利用条件および下記の無保証規定が，そのままの形でソー
     スコード中に含まれていること．
 (2) 本ソフトウェアを，ライブラリ形式など，他のソフトウェア開発に使
     用できる形で再配布する場合には，再配布に伴うドキュメント（利用
     者マニュアルなど）に，上記の著作権表示，この利用条件および下記
     の無保証規定を掲載すること．
 (3) 本ソフトウェアを，機器に組み込むなど，他のソフトウェア開発に使
     用できない形で再配布する場合には，次のいずれかの条件を満たすこ
     と．
   (a) 再配布に伴うドキュメント（利用者マニュアルなど）に，上記の著
       作権表示，この利用条件および下記の無保証規定を掲載すること．
   (b) 再配布の形態を，別に定める方法によって，TOPPERSプロジェクトに
       報告すること．
 (4) 本ソフトウェアの利用により直接的または間接的に生じるいかなる損
     害からも，上記著作権者およびTOPPERSプロジェクトを免責すること．
     また，本ソフトウェアのユーザまたはエンドユーザからのいかなる理
     由に基づく請求からも，上記著作権者およびTOPPERSプロジェクトを
     免責すること．
 
 本ソフトウェアは，無保証で提供されているものである．上記著作権者お
 よびTOPPERSプロジェクトは，本ソフトウェアに関して，特定の使用目的
 に対する適合性も含めて，いかなる保証も行わない．また，本ソフトウェ
 アの利用により直接的または間接的に生じたいかなる損害に関しても，そ
 の責任を負わない．
 
----------------------------------------------------------------------

○拡張パッケージの概要

・周期ハンドラ機能
・アラームハンドラ機能
・システム時刻管理機能
・イベントフラグ機能
・データキュー機能

時間管理機能を実現するためのタイムイベント管理機能も拡張パッケージ中に
含んでいる．

○周期ハンドラ機能

周期ハンドラ機能は，以下のサービスコールをサポートしている．

・CRE_CYC
・sta_cyc
・stp_cyc

ただし，SSPカーネルでは16個までしか周期ハンドラを生成できないという
制限がある．

○アラームハンドラ機能

アラームハンドラ機能は，以下のサービスコールをサポートしている．

・CRE_ALM
・sta_alm
・stp_alm

ただし，SSPカーネルでは16個までしかアラームハンドラを生成できないという
制限がある．

○システム時刻管理機能

システム時刻管理機能は，以下のサービスコールをサポートしている．

・get_tim

○イベントフラグ機能

イベントフラグ機能は，以下のサービスコールをサポートしている．

・CRE_DTQ
・psnd_dtq
・ipsnd_dtq
・prcv_dtq

○データキュー機能

データキュー機能は，以下のサービスコールをサポートしている．

・CRE_FLG
・set_flg
・iset_flg
・clr_flg 
・pol_flg 

○リファレンス

(1) 周期ハンドラ機能

	ER ercd = sta_cyc(ID cycid)
	ER ercd = stp_cyc(ID cycid)

(2) アラームハンドラ機能

	ER ercd = sta_alm(ID almid, RELTIM almtim)
	ER ercd = stp_alm(ID almid)

(3) 時間管理機能

	ER ercd = get_tim(SYSTIM *p_systim)

(4) イベントフラグ機能

    ER set_flg(ID flgid, FLGPTN setptn);
    ER iset_flg(ID flgid, FLGPTN setptn);
    ER clr_flg(ID flgid, FLGPTN clrptn);
    ER pol_flg(ID flgid, FLGPTN waiptn, MODE wfmode, FLGPTN *p_flgptn);

(5) データキュー機能

    ER psnd_dtq(ID dtqid, intptr_t data);
    ER ipsnd_dtq(ID dtqid, intptr_t data);
    ER prcv_dtq(ID dtqid, intptr_t *p_data);


○ 静的API一覧

(1) 周期ハンドラ機能

CRE_CYC(ID cycid, { ATR cycatr, intptr_t exinf,
			CYCHDR cychdr, RELTIM cyctim, RELTIM cycphs })

(2) アラームハンドラ機能

CRE_ALM(ID almid, { ATR almatr, intptr_t exinf, ALMHDR almhdr })

(3) イベントフラグ機能

CRE_FLG(ID flgid, { ATR flgatr, FLGPTN iflgptn })

(4) データキュー機能

CRE_DTQ(ID dtqid, { ATR dtqatr, uint_t dtqcnt, void *dtqmb })

以上．
